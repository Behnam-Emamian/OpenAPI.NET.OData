<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="4.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:DataServices>
    <Schema Namespace="microsoft.graph" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <!-- Review with API council -->
    <!-- Change the namespace to something other than Core OData -->
    <!-- Identify each of these annotations as Im/Mutable and then figure out the external references -->
    <!-- We need the ability to define "type" in custom parameters. for eg. passwordProfile is of type "" -->
    <!-- Org.Graph.Vocab -->
        <Annotations Target="microsoft.graph.GraphService/users">
            <Annotation Term="Org.OData.Capabilities.V1.ChangeTracking">
            <Record>
                <PropertyValue Property="Supported" Bool="true" />
            </Record>
            </Annotation>
            <Annotation Term="Org.OData.Core.V1.Description" String="Description for User resource">
            </Annotation>
            <Annotation Term="Org.OData.Core.V1.LongDescription" String="Description for User resource">
            </Annotation>
            <Annotation Term="Org.Graph.Vocab.HttpRequests">
            <!-- This takes care of httprequest, query params, headers, request body, response -->
             <Collection>
              <Record>
                <PropertyValue Property="Description" String="Description for Http Request "></PropertyValue>
                <PropertyValue Property="Method" String="GET">
                <!-- How are we going to describe the http request description text that's here https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/user_get -->
                </PropertyValue>
                <PropertyValue Property="CustomQueryOptions">
                  <Collection>
                    <Record>
                        <PropertyValue Property="Name" String="accountEnabled"/>
                        <PropertyValue Property="Type" String="boolean" />
                        <PropertyValue Property="Description" String="N/A" />
                        <PropertyValue Property="DocumentationURL" String="N/A" />
                        <PropertyValue Property="Required" Bool="false" />
                        <PropertyValue Property="ExampleValues">
                          <Collection>
                            <Record>
                              <PropertyValue Property="Value" String="JSON example 1"/>
                              <PropertyValue Property="Description" String="JSON example 2"/>
                            </Record>
                          </Collection>
                        </PropertyValue>
                    </Record>
                  </Collection>
                </PropertyValue>
                <PropertyValue Property="CustomHeaders">
                 <Collection>
                    <Record>
                        <PropertyValue Property="Name" String="accountEnabled"/>
                        <PropertyValue Property="Type" String="boolean" />
                        <PropertyValue Property="Description" String="N/A" />
                        <PropertyValue Property="DocumentationURL" String="N/A" />
                        <PropertyValue Property="Required" Bool="false" />
                        <PropertyValue Property="ExampleValues">
                          <Collection>
                            <Record>
                              <PropertyValue Property="Value" String="JSON example 1"/>
                              <PropertyValue Property="Description" String="JSON example 2"/>
                            </Record>
                          </Collection>
                        </PropertyValue>
                    </Record>
                </Collection>
                </PropertyValue>
                <PropertyValue Property="HttpRequestBody">
                   <Collection>
                    <Record>
                        <PropertyValue Property="Name" String="accountEnabled"/>
                        <PropertyValue Property="Type" String="boolean" />
                        <PropertyValue Property="Description" String="N/A" />
                        <PropertyValue Property="DocumentationURL" String="N/A" />
                        <PropertyValue Property="Required" Bool="false" />
                        <PropertyValue Property="ExampleValues">
                          <Collection>
                            <Record>
                              <PropertyValue Property="Value" String="JSON example 1"/>
                              <PropertyValue Property="Description" String="JSON example 2"/>
                            </Record>
                          </Collection>
                        </PropertyValue>
                    </Record>
                   <Record>
                        <PropertyValue Property="Name" String="accountEnabled"/>
                        <PropertyValue Property="Type" String="boolean" />
                        <PropertyValue Property="Description" String="N/A" />
                        <PropertyValue Property="DocumentationURL" String="N/A" />
                        <PropertyValue Property="Required" Bool="false" />
                        <PropertyValue Property="ExampleValues">
                          <Collection>
                            <Record>
                              <PropertyValue Property="Value" String="JSON example 1"/>
                              <PropertyValue Property="Description" String="JSON example 2"/>
                            </Record>
                          </Collection>
                        </PropertyValue>
                    </Record>
                  </Collection>
                </PropertyValue>
                <PropertyValue Property="HttpResponse">
                  <Record>
                    <PropertyValue Property="ResponseCode" String="200"></PropertyValue>
                    <PropertyValue Property="Description" String="200"></PropertyValue>
                    <PropertyValue Property="Conditions">
                        <Collection>
                          <Record>
                            <PropertyValue Property="ODataErrorCode" String="" />
                            <PropertyValue Property="Description" String="Description of the error code" />
                          </Record>
                        </Collection>
                    </PropertyValue>
                  </Record>
                </PropertyValue>
               </Record>
              </Collection>
            </Annotation>
            <!-- Resource inheritance (description)
            Look into if we should do anyOf/all of for this representation. 
            --> 
            <!-- Method extensions (description) 
            This should probably be moved out of here. The only thing we should define here is if this resource supports extensions or not, then provide a link to extensions and schema 
            -->
            <!-- Relationships  
            These need to be defined as 'link objects'
            -->
        </Annotations>
        <!-- Properties (description) -->
        <Annotations Target="microsoft.graph.user/aboutMe">
          <Annotation Term="Org.OData.Core.V1.Description" String="A freeform text entry field for the user to describe themselves."></Annotation>
        </Annotations>
        <Annotations Target="microsoft.graph.user/accountEnabled">
          <Annotation Term="Org.OData.Core.V1.Description" String="true if the account is enabled; otherwise, false. This property is required when a user is created. Supports $filter."></Annotation>
        </Annotations>
      </Schema>
    
<!-- User annotations -->
      <Schema Namespace="Org.Graph.Vocab" Alias="Graph" xmlns="http://docs.oasis-open.org/odata/ns/edm">
        <Term Name="HttpRequests" Type="Collection(Graph.HttpRequest)" AppliesTo="EntitySet Singleton ActionImport FunctionImport Action Function">
            <Annotation Term="Core.Description" String="Describes possible HTTP requests" />
            <Annotation Term="Core.LongDescription" String="The list need not be complete. It may be used to generate API documentation, so restricting it to the most common and most important responses may increase readability." />
        </Term>
        <ComplexType Name="HttpRequest">
            <Property Name="Description" Type="Edm.String" />
            <Property Name="Method" Type="Edm.String" />
            <Property Name="CustomQueryOptions" Type="Collection(Graph.CustomParameter)" />
            <Property Name="CustomHeaders" Type="Collection(Graph.CustomParameter)" />
            <Property Name="HttpRequestBody" Type="Collection(Graph.CustomParameter)" />
            <Property Name="HttpResponse" Type="Graph.HttpResponse" />
        </ComplexType>
        
        <ComplexType Name="HttpResponse">
            <Property Name="ResponseCode" Type="Edm.String" />
            <Property Name="Description" Type="Edm.String" />
            <Property Name="Conditions" Type="Collection(Graph.HttpStatusCodeCondition)" />
        </ComplexType>
        
        <ComplexType Name="HttpStatusCodeCondition">
            <Property Name="ODataErrorCode" Type="Edm.String" />
            <Property Name="Description" Type="Edm.String" />
        </ComplexType>
        
        <ComplexType Name="CustomParameter">
            <Property Name="Name" Type="Edm.String" Nullable="false" />
            <Property Name="Type" Type="Edm.String" Nullable="false" />
            <Property Name="Description" Type="Edm.String" />
            <Property Name="DocumentationURL" Type="Edm.String" />
            <Property Name="Required" Type="Edm.Boolean" Nullable="false" />
            <Property Name="ExampleValues" Type="Collection(Graph.CustomParameterExampleValue)" Nullable="false" />
        </ComplexType>
        <ComplexType Name="CustomParameterExampleValue">
            <Property Name="Value" Type="Edm.String" Nullable="false" />
            <Property Name="Description" Type="Edm.String" Nullable="false" />
        </ComplexType>
     </Schema>
  </edmx:DataServices>
</edmx:Edmx>